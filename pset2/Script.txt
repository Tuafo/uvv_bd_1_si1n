/* QUESTÃO 01: prepare um relatorio que mostre a madia salarial dos funcionarios de cada departamento. */

SELECT 
    numero_departamento 	      	                                            AS departamento,
    AVG(salario)		                                                    AS media_salarial
FROM funcionario
GROUP BY numero_departamento;

/* QUESTÃO 02: prepare um relatorio que mostre a media salarial dos homens e das mulheres. */

SELECT 
    sexo 		                                                            AS genero,
    AVG(salario) 	              	                                            AS media_salarial
FROM funcionario
GROUP BY sexo;

/* QUESTÃO 03: prepare um relatório que liste o nome dos departamentos e, para
cada departamento, inclua as seguintes informações de seus funcionários: o nome
completo, a data de nascimento, a idade em anos completos e o salário. */

SELECT
    CONCAT(primeiro_nome,' ', nome_meio,' ', ultimo_nome)                       AS funcionario,
    d.nome_departamento                                                         AS departamento,
    f.numero_departamento,
    te.horas
FROM funcionario f
INNER JOIN trabalha_em te ON ( te.cpf_funcionario = f.cpf)
INNER JOIN departamento d ON ( d.numero_departamento = f.numero_departamento);
